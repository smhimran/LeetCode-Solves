This is how I made the program fastest. I did modulo operation only when necessary.
I also changed the language to C++. Let's see how far it goes.